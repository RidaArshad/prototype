<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Railway AI Simulation</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
            height: 100%;
            overflow: hidden;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding: 1rem;
            box-sizing: border-box;
        }

        header {
            text-align: center;
            padding-bottom: 1rem;
            border-bottom: 1px solid #4a5568;
        }

        header h1 {
            margin: 0;
            color: #63b3ed;
        }
        header h2 {
            margin: 0;
            font-weight: 400;
            color: #a0aec0;
        }

        main {
            flex-grow: 1;
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            min-height: 0;
        }

        #map-container {
            flex-grow: 1;
            position: relative;
            border: 1px solid #4a5568;
            border-radius: 8px;
            background-color: #2d3748;
            overflow: hidden;
        }

        #track-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        #dashboard {
            width: 450px;
            flex-shrink: 0;
            background-color: #2d3748;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 1rem;
            overflow-y: auto;
        }

        #train-status-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }

        #train-status-table th, #train-status-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #4a5568;
        }

        #train-status-table th {
            color: #a0aec0;
        }

        .node {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }
        .node.station, .node.junction {
            background-color: #f7fafc;
            border: 2px solid #2d3748;
        }
        .node.signal {
            background-color: #f6ad55;
            width: 10px;
            height: 10px;
        }

        .node-label {
            position: absolute;
            color: #a0aec0;
            font-size: 11px;
            z-index: 11;
            transform: translate(-50%, 0);
            text-shadow: 0 0 3px #1a202c;
            pointer-events: none;
        }

        .train {
            position: absolute;
            width: 18px;
            height: 18px;
            border-radius: 3px;
            transform: translate(-50%, -50%);
            z-index: 20;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: #1a202c;
            transition: left 1s linear, top 1s linear;
            box-shadow: 0 0 8px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .train.Express { background-color: #f56565; }
        .train.Passenger { background-color: #48bb78; }
        .train.Goods { background-color: #a0aec0; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI-Powered Railway Traffic Control</h1>
            <h2>Dynamic Blocking Simulation</h2>
        </header>
        <main>
            <div id="map-container">
                <canvas id="track-canvas"></canvas>
                <svg id="railway-svg" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;">
                    <!-- Railway tracks -->
                    <line x1="10%" y1="50%" x2="90%" y2="50%" stroke="#6b7280" stroke-width="6" stroke-linecap="round"/>
                    <line x1="10%" y1="45%" x2="90%" y2="45%" stroke="#6b7280" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="10%" y1="55%" x2="90%" y2="55%" stroke="#6b7280" stroke-width="2" stroke-dasharray="5,5"/>
                    
                    <!-- Track connections -->
                    <line x1="30%" y1="50%" x2="35%" y2="45%" stroke="#6b7280" stroke-width="3"/>
                    <line x1="35%" y1="45%" x2="40%" y2="50%" stroke="#6b7280" stroke-width="3"/>
                    <line x1="60%" y1="50%" x2="65%" y2="55%" stroke="#6b7280" stroke-width="3"/>
                    <line x1="65%" y1="55%" x2="70%" y2="50%" stroke="#6b7280" stroke-width="3"/>
                    
                    <!-- Stations -->
                    <rect x="18%" y="45%" width="4%" height="10%" rx="2" fill="#2563eb" opacity="0.8"/>
                    <text x="20%" y="42%" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">Ballari Junction</text>
                    
                    <rect x="58%" y="45%" width="4%" height="10%" rx="2" fill="#2563eb" opacity="0.8"/>
                    <text x="60%" y="42%" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">Toranagallu</text>
                    
                    <!-- Signals -->
                    <circle cx="35%" cy="50%" r="8" fill="#ef4444" id="signal-1"/>
                    <text x="35%" y="35%" text-anchor="middle" fill="#e2e8f0" font-size="11">Signal BLR-1</text>
                    
                    <circle cx="65%" cy="50%" r="8" fill="#22c55e" id="signal-2"/>
                    <text x="65%" y="35%" text-anchor="middle" fill="#e2e8f0" font-size="11">Signal TOR-1</text>
                    
                    <!-- Trains -->
                    <rect x="25%" y="48%" width="3%" height="4%" rx="2" fill="#f56565" id="train-express">
                        <animateTransform attributeName="transform" type="translate" 
                            values="0,0; 50,0; 0,0" dur="8s" repeatCount="indefinite"/>
                    </rect>
                    <text x="26.5%" y="50.5%" text-anchor="middle" fill="#1a202c" font-size="10" font-weight="bold">E</text>
                    
                    <rect x="45%" y="48%" width="3%" height="4%" rx="2" fill="#48bb78" id="train-local">
                        <animateTransform attributeName="transform" type="translate" 
                            values="0,0; 40,0; 0,0" dur="12s" repeatCount="indefinite"/>
                    </rect>
                    <text x="46.5%" y="50.5%" text-anchor="middle" fill="#1a202c" font-size="10" font-weight="bold">L</text>
                    
                    <rect x="75%" y="48%" width="3%" height="4%" rx="2" fill="#a0aec0" id="train-goods">
                        <animateTransform attributeName="transform" type="translate" 
                            values="0,0; 30,0; 0,0" dur="15s" repeatCount="indefinite"/>
                    </rect>
                    <text x="76.5%" y="50.5%" text-anchor="middle" fill="#1a202c" font-size="10" font-weight="bold">G</text>
                </svg>
                
                <!-- Control Panel Overlay -->
                <div style="position: absolute; top: 20px; left: 20px; background: rgba(26, 32, 44, 0.9); padding: 15px; border-radius: 8px; color: #e2e8f0;">
                    <h3 style="margin: 0 0 10px 0; color: #63b3ed;">Dynamic Railway Simulation</h3>
                    <p style="margin: 0; font-size: 14px; color: #a0aec0;">AI-powered traffic control with dynamic blocking</p>
                    <div style="margin-top: 15px;">
                        <button id="sim-control" style="background: #4f46e5; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-right: 10px;">Start Simulation</button>
                        <button id="reset-sim" style="background: #6b7280; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Reset</button>
                    </div>
                </div>
            </div>
            <div id="dashboard">
                <h3>Live Train Status</h3>
                <table id="train-status-table">
                    <thead>
                        <tr>
                            <th>Train ID</th>
                            <th>Type</th>
                            <th>Status</th>
                            <th>Speed (km/h)</th>
                            <th>Position (km)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Express_101</td>
                            <td>Express</td>
                            <td>Running</td>
                            <td>90</td>
                            <td>10.0</td>
                        </tr>
                        <tr>
                            <td>Local_202</td>
                            <td>Passenger</td>
                            <td>Running</td>
                            <td>40</td>
                            <td>15.0</td>
                        </tr>
                        <tr>
                            <td>Goods_303</td>
                            <td>Goods</td>
                            <td>Running</td>
                            <td>30</td>
                            <td>5.0</td>
                        </tr>
                    </tbody>
                </table>
                <div style="margin-top: 2rem; padding: 1rem; background-color: #2a4365; border-radius: 8px;">
                    <h4 style="color: #63b3ed; margin-top: 0;">Dynamic Features</h4>
                    <ul style="color: #a0aec0; font-size: 0.9em;">
                        <li>AI-powered speed optimization</li>
                        <li>Real-time collision avoidance</li>
                        <li>Dynamic signal control</li>
                        <li>Priority-based routing</li>
                        <li>Adaptive braking systems</li>
                    </ul>
                </div>
            </div>
        </main>
    </div>

    <script>
        let isSimulationRunning = false;
        let simulationInterval;
        
        // Initialize simulation controls
        document.addEventListener('DOMContentLoaded', function() {
            const simControl = document.getElementById('sim-control');
            const resetSim = document.getElementById('reset-sim');
            const signals = document.querySelectorAll('[id^="signal-"]');
            const trains = document.querySelectorAll('[id^="train-"]');
            
            simControl.addEventListener('click', function() {
                if (isSimulationRunning) {
                    stopSimulation();
                    simControl.textContent = 'Start Simulation';
                } else {
                    startSimulation();
                    simControl.textContent = 'Stop Simulation';
                }
            });
            
            resetSim.addEventListener('click', function() {
                stopSimulation();
                resetSimulation();
                simControl.textContent = 'Start Simulation';
            });
            
            // Start with simulation running
            startSimulation();
            simControl.textContent = 'Stop Simulation';
        });
        
        function startSimulation() {
            isSimulationRunning = true;
            simulationInterval = setInterval(() => {
                updateSignalStates();
                updateTrainStatus();
            }, 1000);
        }
        
        function stopSimulation() {
            isSimulationRunning = false;
            if (simulationInterval) {
                clearInterval(simulationInterval);
            }
        }
        
        function resetSimulation() {
            // Reset signals to red
            document.getElementById('signal-1').setAttribute('fill', '#ef4444');
            document.getElementById('signal-2').setAttribute('fill', '#ef4444');
            
            // Reset train status
            updateTrainStatus();
        }
        
        function updateSignalStates() {
            const signal1 = document.getElementById('signal-1');
            const signal2 = document.getElementById('signal-2');
            
            // Simulate dynamic signal changes
            const time = Date.now() / 1000;
            const signal1State = Math.sin(time * 0.5) > 0 ? 'green' : 'red';
            const signal2State = Math.cos(time * 0.3) > 0 ? 'green' : 'yellow';
            
            signal1.setAttribute('fill', signal1State === 'green' ? '#22c55e' : '#ef4444');
            signal2.setAttribute('fill', signal2State === 'green' ? '#22c55e' : signal2State === 'yellow' ? '#facc15' : '#ef4444');
        }
        
        function updateTrainStatus() {
            const rows = document.querySelectorAll('#train-status-table tbody tr');
            const baseSpeeds = [90, 40, 30];
            const basePositions = [10.0, 15.0, 5.0];
            
            rows.forEach((row, index) => {
                const speedCell = row.cells[3];
                const positionCell = row.cells[4];
                const statusCell = row.cells[2];
                
                // Simulate realistic variations
                const speedVariation = Math.floor(Math.random() * 10 - 5);
                const positionVariation = (Math.random() * 0.2 - 0.1);
                
                const currentSpeed = Math.max(0, baseSpeeds[index] + speedVariation);
                const currentPosition = Math.max(0, basePositions[index] + positionVariation);
                
                speedCell.textContent = currentSpeed;
                positionCell.textContent = currentPosition.toFixed(1);
                
                // Update status based on speed
                if (currentSpeed < 5) {
                    statusCell.textContent = 'Stopped';
                    statusCell.style.color = '#ef4444';
                } else if (currentSpeed < baseSpeeds[index] * 0.7) {
                    statusCell.textContent = 'Slow';
                    statusCell.style.color = '#facc15';
                } else {
                    statusCell.textContent = 'Running';
                    statusCell.style.color = '#22c55e';
                }
            });
        }
    </script>
</body>
</html>
